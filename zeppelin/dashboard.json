{"paragraphs":[{"text":"import org.apache.spark._\nimport org.apache.spark.streaming._\nimport org.apache.kafka.clients.consumer.ConsumerRecord\nimport org.apache.kafka.common.serialization.StringDeserializer\nimport org.apache.spark.streaming.kafka010._\nimport org.apache.spark.streaming.kafka010.LocationStrategies.PreferConsistent\nimport org.apache.spark.streaming.kafka010.ConsumerStrategies.Subscribe","user":"anonymous","dateUpdated":"2019-04-05T05:20:12+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.streaming._\nimport org.apache.kafka.clients.consumer.ConsumerRecord\nimport org.apache.kafka.common.serialization.StringDeserializer\nimport org.apache.spark.streaming.kafka010._\nimport org.apache.spark.streaming.kafka010.LocationStrategies.PreferConsistent\nimport org.apache.spark.streaming.kafka010.ConsumerStrategies.Subscribe\n"}]},"apps":[],"jobName":"paragraph_1554381208624_818611436","id":"20190404-143328_1242427776","dateCreated":"2019-04-04T14:33:28+0200","dateStarted":"2019-04-05T05:20:12+0200","dateFinished":"2019-04-05T05:20:29+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:262"},{"text":"val conf = new SparkConf().setAppName(\"Romain\").set(\"spark.driver.allowMultipleContexts\", \"true\").setMaster(\"local[*]\")\nval ssc = new StreamingContext(conf, Seconds(5))\n\nval kafkaParams = Map[String, Object](\n  \"bootstrap.servers\" -> \"localhost:9092\",\n  \"key.deserializer\" -> \"org.apache.kafka.common.serialization.StringDeserializer\",\n  \"value.deserializer\" -> \"org.apache.kafka.common.serialization.StringDeserializer\",\n  \"group.id\" -> \"something\"\n)\n\nval topics = Array(\"beeData\")\nval stream = KafkaUtils.createDirectStream[String, String](\n  ssc,\n  PreferConsistent,\n  Subscribe[String, String](topics, kafkaParams)\n)\n\n//stream.map(record => (record.key, record.value))","user":"anonymous","dateUpdated":"2019-04-05T05:20:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":144.35,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"conf: org.apache.spark.SparkConf = org.apache.spark.SparkConf@6ce88731\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@1e28c4e9\nkafkaParams: scala.collection.immutable.Map[String,Object] = Map(bootstrap.servers -> localhost:9092, key.deserializer -> org.apache.kafka.common.serialization.StringDeserializer, value.deserializer -> org.apache.kafka.common.serialization.StringDeserializer, group.id -> something)\ntopics: Array[String] = Array(test)\nstream: org.apache.spark.streaming.dstream.InputDStream[org.apache.kafka.clients.consumer.ConsumerRecord[String,String]] = org.apache.spark.streaming.kafka010.DirectKafkaInputDStream@7fd2b231\n"}]},"apps":[],"jobName":"paragraph_1554380348793_1670691773","id":"20190404-141908_2083182592","dateCreated":"2019-04-04T14:19:08+0200","dateStarted":"2019-04-05T05:20:32+0200","dateFinished":"2019-04-05T05:20:34+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"//val keys = stream.map(record => (record.key))\nval values = stream.map(record => (record.value))\n//val ids = values.map(record => spark.read.json(Seq(record).toDS))\n\n\nstream.foreachRDD(rddRaw => {\n    val data = rddRaw.map(_.value.toString)// => spark.read.json(line)).collect()\n    val df = spark.read.json(data)\n    if(df.columns.contains(\"fuel\")){\n        df.registerTempTable(\"information\")\n        //df.createOrReplaceTempView(\"information\")\n        //df.select(\"fuel\").collect.foreach(println)\n        //df.write.saveAsTable(\"information\")\n    }\n})\n\n//print(ids.select($\"id\").collect.foreach(println))\n\nssc.start()\nssc.awaitTerminationOrTimeout(25000)\n//ssc.awaitTermination()\n\n","user":"anonymous","dateUpdated":"2019-04-05T05:20:40+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":304,"optionOpen":false}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there were two deprecation warnings; re-run with -deprecation for details\nvalues: org.apache.spark.streaming.dstream.DStream[String] = org.apache.spark.streaming.dstream.MappedDStream@73c69f31\nres1: Boolean = false\n"}]},"apps":[],"jobName":"paragraph_1554380373144_579600167","id":"20190404-141933_516629800","dateCreated":"2019-04-04T14:19:33+0200","dateStarted":"2019-04-05T05:20:40+0200","dateFinished":"2019-04-05T05:21:07+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264"},{"text":"%sql\nselect id, count(1) value\nfrom information\ngroup by id\norder by id","user":"anonymous","dateUpdated":"2019-04-05T05:21:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"id","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"value","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"id":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tvalue\n55\t15\n65\t2\n72\t5\n77\t8\n78\t6\n94\t4\n97\t6\n101\t10\n102\t5\n105\t7\n106\t8\n107\t1\n108\t19\n109\t18\n110\t12\n111\t5\n112\t15\n113\t35\n115\t6\n116\t7\n117\t18\n118\t1\n119\t43\n120\t27\n121\t17\n122\t1\n123\t2\n124\t5\n125\t18\n126\t12\n127\t1\n128\t24\n129\t16\n130\t6\n131\t1\n132\t29\n133\t18\n134\t6\n135\t24\n136\t18\n137\t19\n138\t1\n139\t6\n140\t1\n141\t1\n142\t12\n143\t17\n144\t18\n145\t17\n146\t6\n147\t11\n148\t1\n149\t2\n150\t3\n151\t7\n152\t9\n153\t1\n154\t9\n155\t8\n156\t7\n157\t6\n158\t1\n159\t4\n160\t3\n161\t2\n162\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1554414430237_161765211","id":"20190404-234710_385497447","dateCreated":"2019-04-04T23:47:10+0200","dateStarted":"2019-04-05T05:21:34+0200","dateFinished":"2019-04-05T05:21:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265"},{"text":"%sql \nselect fuel, count(1) value\nfrom information\nwhere fuel >= 0\ngroup by fuel\norder by fuel","user":"anonymous","dateUpdated":"2019-04-05T05:21:46+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":396,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"fuel":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false}},"commonSetting":{},"keys":[{"name":"fuel","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"value","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"fuel\tvalue\n1\t3\n4\t1\n7\t3\n10\t2\n13\t2\n16\t2\n19\t3\n22\t3\n25\t3\n28\t3\n31\t2\n34\t5\n37\t5\n40\t2\n43\t4\n46\t6\n49\t5\n52\t2\n55\t4\n58\t6\n61\t3\n64\t3\n67\t2\n70\t8\n73\t5\n76\t5\n79\t2\n82\t13\n85\t4\n88\t6\n91\t3\n94\t10\n97\t3\n100\t8\n103\t4\n106\t14\n109\t7\n112\t8\n115\t3\n118\t15\n121\t3\n124\t9\n127\t4\n130\t16\n133\t3\n136\t10\n139\t2\n142\t16\n145\t3\n148\t10\n151\t2\n154\t18\n160\t4\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1554385181977_627322515","id":"20190404-153941_940891903","dateCreated":"2019-04-04T15:39:41+0200","dateStarted":"2019-04-05T05:21:42+0200","dateFinished":"2019-04-05T05:21:45+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266"},{"text":"%sql \nselect id, cause\nfrom information\nwhere die = true","user":"anonymous","dateUpdated":"2019-04-05T05:23:09+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":178,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"id":"string","cause":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\tcause\n836\tfuel\n841\tfuel\n847\twind\n856\twind\n850\twind\n851\twind\n858\twind\n848\tfuel\n859\twind\n852\twind\n868\twind\n845\tfuel\n854\tfuel\n838\tfuel\n853\tfuel\n861\tcold\n863\tcold\n870\tcold\n842\tfuel\n866\twind\n839\tfuel\n871\twind\n867\tcold\n879\tcold\n864\tfuel\n878\twind\n860\tcold\n865\tfuel\n882\tcold\n883\tcold\n877\tcold\n885\tcold\n857\tfuel\n869\tfuel\n873\tcold\n862\tfuel\n886\tcold\n889\tcold\n874\tfuel\n876\tfuel\n875\twind\n892\tcold\n881\tfuel\n896\twind\n888\tcold\n893\tcold\n899\tcold\n872\tfuel\n884\tfuel\n900\tcold\n880\tfuel\n904\tcold\n890\tfuel\n895\tfuel\n905\twind\n887\tfuel\n898\tfuel\n903\tcold\n914\tcold\n916\tcold\n915\twind\n897\twind\n902\tfuel\n901\tfuel\n920\tcold\n891\tfuel\n908\tfuel\n907\tfuel\n906\tcold\n919\tfuel\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1554387644853_6846054","id":"20190404-162044_1412112321","dateCreated":"2019-04-04T16:20:44+0200","dateStarted":"2019-04-05T05:23:02+0200","dateFinished":"2019-04-05T05:23:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://10.0.2.15:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"text":"%sql\nselect disease, count(1) value \nfrom information \nwhere disease != \"none\" and disease != \"empty\"\ngroup by disease \norder by disease","user":"anonymous","dateUpdated":"2019-04-05T05:22:19+0200","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":330,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"disease":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{"disease!empty|none":"","disease!":"empty|none"},"forms":{}},"apps":[],"jobName":"paragraph_1554434114947_-1342430670","id":"20190405-051514_1575232518","dateCreated":"2019-04-05T05:15:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3021","dateFinished":"2019-04-05T05:22:21+0200","dateStarted":"2019-04-05T05:22:19+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"disease\tvalue\nchickenpox\t57\nflu\t32\ntetanus\t21\nwhooping cough\t10\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\nselect weather, count(1) value \nfrom information \ngroup by weather \norder by weather","user":"anonymous","dateUpdated":"2019-04-05T05:22:24+0200","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":348,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"weather":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"weather","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"value","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554434184495_1128521892","id":"20190405-051624_1985309044","dateCreated":"2019-04-05T05:16:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3099","dateFinished":"2019-04-05T05:22:23+0200","dateStarted":"2019-04-05T05:22:22+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"weather\tvalue\nrain\t82\nsnow\t17\nsun\t300\nwind\t206\n"},{"type":"TEXT","data":""}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2019-04-05T05:22:08+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554434528298_-2014428077","id":"20190405-052208_1608899461","dateCreated":"2019-04-05T05:22:08+0200","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7467"}],"name":"Hello","id":"2E9JN15B7","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}
